---
import Base from '../../layouts/Base.astro';
import { getCollection } from 'astro:content';

const projects = (await getCollection('work', ({ data }) => !data.draft))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<Base title="Work - Abhin Rustagi" description="Selected projects and case studies from my freelance work.">
  <section>
    <div class="container section-wrapper">
      <h2 class="section-title">Work</h2>
      <p class="text-muted desc">Selected projects and case studies from my freelance work.</p>

      {projects.length === 0 ? (
        <p class="empty text-muted">No projects yet. Check back soon.</p>
      ) : (
        <div class="timeline">
          {projects.map((project, i) => (
            <div class={`timeline-item animate-in animate-in-delay-${Math.min(i + 1, 4)}`}>
              <span class="timeline-date">{project.data.date.getFullYear()}</span>
              <div class="timeline-content">
                <a href={`/work/${project.slug}`} class="work-link">{project.data.title}</a>
                <p class="work-desc">{project.data.description}</p>
                {project.data.tech && project.data.tech.length > 0 && (
                  <p class="work-tech">{project.data.tech.join(' / ')}</p>
                )}
              </div>
            </div>
          ))}
        </div>
      )}
    </div>
  </section>
</Base>

<style>
  .page-header {
    margin-bottom: var(--space-xl);
  }

  .page-header h1 {
    margin-bottom: var(--space-sm);
  }

  .empty {
    padding: var(--space-xl) 0;
  }

  .work-link {
    font-family: var(--font-sans);
    font-weight: 500;
    font-size: 1rem;
    color: var(--text);
  }

  .work-link:hover {
    color: var(--accent);
  }

  .work-desc {
    margin: var(--space-xs) 0 0;
    font-size: 0.9375rem;
    color: var(--text-muted);
  }

  .work-tech {
    margin: var(--space-xs) 0 0;
    font-size: 0.8125rem;
    color: var(--text-muted);
    opacity: 0.8;
  }
</style>
