---
import Base from "../../layouts/Base.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const projects = await getCollection("work");
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

const { project } = Astro.props;
const { Content } = await project.render();
---

<Base
  title={`${project.data.title} - Abhin Rustagi`}
  description={project.data.description}
>
  <article class="section">
    <div class="container section-wrapper">
      <div class="project-header animate-in">
        <div class="meta text-muted text-sm">
          <span class="year">{project.data.date.getFullYear()}</span>
          {
            project.data.client && (
              <span class="client">/ {project.data.client}</span>
            )
          }
        </div>
        <h1>{project.data.title}</h1>
      </div>
      <div class="prose animate-in animate-in-delay-1">
        <Content />
      </div>
      <a href="/work" class="back-link">&larr; Back to all work</a>
    </div>
  </article>
</Base>

<style>
  .project-header {
    margin-bottom: var(--space-lg);
  }

  .meta {
    display: flex;
    gap: var(--space-sm);
    margin-bottom: var(--space-sm);
  }

  .project-header h1 {
    font-size: 1.25rem;
    margin-bottom: var(--space-md);
  }

  .back-link {
    font-size: 0.875rem;
    color: var(--text-muted);
  }

  .back-link:hover {
    color: var(--accent);
  }
</style>
